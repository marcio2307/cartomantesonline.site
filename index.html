<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Consultores Disponíveis</title>

<!-- ✅ PWA -->
<link rel="manifest" href="manifest.json" />
<meta name="theme-color" content="#000000" />
<link rel="icon" href="logo.png" />

<link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@700&family=Poppins:wght@400;600;700&display=swap" rel="stylesheet" />

<style>
:root{
  --gold-1:#fff0a6;
  --gold-2:#f6e27a;
  --gold-3:#c7a008;
  --gold-4:#b8860b;
  --black:#000000;

  --btn-h:56px;
  --btn-px:14px;
}

body{
  margin:0;
  min-height:100vh;
  background:
    radial-gradient(900px 420px at 15% 10%, rgba(199,160,8,0.20), rgba(0,0,0,0) 60%),
    radial-gradient(900px 420px at 85% 20%, rgba(199,160,8,0.16), rgba(0,0,0,0) 60%),
    radial-gradient(1200px 520px at 50% 120%, rgba(199,160,8,0.10), rgba(0,0,0,0) 65%),
    #000;
  font-family:'Poppins',sans-serif;
  color:#fff;
}

/* ✅ CARROSSEL DE BANNERS (SEM CORTE) */
.banner-carousel{
  width:100%;
  margin:0;
  border-bottom:2px solid var(--gold-3);
  box-shadow:0 18px 60px rgba(0,0,0,0.55);
  position:relative;
  background:#000;
  overflow:hidden;
}
.banner-carousel::after{
  content:"";
  position:absolute;
  inset:0;
  background:
    radial-gradient(1200px 520px at 50% 15%, rgba(0,0,0,0.10), rgba(0,0,0,0.48) 60%),
    linear-gradient(180deg, rgba(0,0,0,0.02) 0%, rgba(0,0,0,0.35) 100%);
  pointer-events:none;
  z-index:3;
}
.banner-carousel .slide{
  position:absolute;
  inset:0;
  opacity:0;
  transition:opacity .45s ease;
  z-index:1;
}
.banner-carousel .slide.active{
  opacity:1;
  z-index:2;
}
.banner-carousel img{
  width:100%;
  height:auto;
  display:block;
}
.banner-carousel .spacer{
  width:100%;
  pointer-events:none;
}
.banner-carousel .spacer img{
  opacity:0;
  visibility:hidden;
}

@media (max-width:480px){
  .banner-carousel{ border-bottom-width:1px; }
  :root{
    --btn-h:64px;
    --btn-px:16px;
  }
}

.page{
  padding:22px 20px 28px;
}

/* Hero */
.hero{
  max-width:1200px;
  margin:0 auto 22px;
  text-align:center;
  padding:0 10px;
}
.hero h1{
  margin:0 0 10px;
  font-size:36px;
  font-weight:800;
  letter-spacing:0.2px;
  color:transparent;
  background-image: linear-gradient(180deg, var(--gold-2) 0%, var(--gold-3) 42%, var(--gold-1) 72%, var(--gold-4) 100%);
  -webkit-background-clip:text;
  background-clip:text;
  text-shadow:0 0 22px rgba(199,160,8,0.15);
}
.hero p{
  margin:0;
  font-size:15px;
  line-height:1.65;
  color:rgba(255,255,255,0.88);
  max-width:980px;
  margin-left:auto;
  margin-right:auto;
}

/* Grid */
.container{
  display:grid;
  grid-template-columns:repeat(4,1fr);
  gap:20px;
  max-width:1200px;
  margin:0 auto;
}
@media (max-width:1024px){ .container{ grid-template-columns:repeat(3,1fr); } }
@media (max-width:768px){
  .container{ grid-template-columns:repeat(2,1fr); gap:15px; }
  .hero h1{ font-size:30px; }
}
@media (max-width:480px){
  .container{ grid-template-columns:repeat(2,1fr); gap:12px; }
  .hero h1{ font-size:26px; }
}

/* ✅ Cards elegantes */
.card{
  position:relative;
  border-radius:18px;
  overflow:hidden;
  isolation:isolate;

  background:
    radial-gradient(560px 260px at 50% -10%, rgba(199,160,8,0.25), rgba(0,0,0,0) 60%),
    linear-gradient(180deg, rgba(18,18,18,0.86) 0%, rgba(5,5,5,0.98) 100%);

  border:1px solid rgba(199,160,8,0.55);
  box-shadow:
    0 18px 44px rgba(0,0,0,0.60),
    0 0 0 1px rgba(255,240,166,0.08) inset;

  transform:none !important;
  transition:none;
}
.card::before{
  content:"";
  position:absolute;
  inset:-2px;
  background:
    radial-gradient(520px 220px at 50% 0%, rgba(246,226,122,0.22), rgba(0,0,0,0) 60%),
    radial-gradient(180px 120px at 18% 18%, rgba(255,240,166,0.10), rgba(0,0,0,0) 70%),
    radial-gradient(180px 120px at 82% 28%, rgba(255,240,166,0.08), rgba(0,0,0,0) 70%);
  opacity:.9;
  pointer-events:none;
  z-index:0;
}
.card::after{
  content:"";
  position:absolute;
  inset:0;
  background:
    linear-gradient(120deg,
      rgba(255,240,166,0.00) 0%,
      rgba(255,240,166,0.04) 28%,
      rgba(255,240,166,0.00) 55%,
      rgba(255,240,166,0.00) 100%);
  mix-blend-mode:screen;
  opacity:.55;
  pointer-events:none;
  z-index:1;
}
.card:hover{
  border-color:rgba(246,226,122,0.95);
  box-shadow:
    0 18px 44px rgba(0,0,0,0.60),
    0 0 30px rgba(199,160,8,0.14),
    0 0 0 1px rgba(255,240,166,0.10) inset;
}

.card .img-wrap{
  position:relative;
  z-index:2;
  padding:10px 10px 0;
}
.card .img-wrap img{
  width:100%;
  height:240px;
  object-fit:cover;
  display:block;
  border-radius:14px;
  border:1px solid rgba(199,160,8,0.35);
  box-shadow:
    0 12px 30px rgba(0,0,0,0.55),
    0 0 0 1px rgba(255,240,166,0.06) inset;
  filter:saturate(1.06) contrast(1.06);
}
.card .img-wrap::after{
  content:"";
  position:absolute;
  left:10px; right:10px; bottom:0;
  height:86px;
  border-radius:0 0 14px 14px;
  background:linear-gradient(180deg, rgba(0,0,0,0) 0%, rgba(0,0,0,0.85) 100%);
  pointer-events:none;
}

/* Badge */
.badge{
  position:absolute;
  top:16px;
  left:16px;
  padding:7px 11px;
  font-size:11px;
  border-radius:999px;
  text-transform:uppercase;
  color:#fff;
  font-weight:900;
  letter-spacing:0.6px;
  box-shadow:0 10px 18px rgba(0,0,0,0.50);
  z-index:4;
  border:1px solid rgba(255,255,255,0.18);
  background:linear-gradient(180deg, #2ecc71 0%, #1f9b50 100%);
}
.badge.ocupado{ background:linear-gradient(180deg, #f39c12 0%, #d35400 100%); }
.badge.indisp{ background:linear-gradient(180deg, #e74c3c 0%, #c0392b 100%); }

.content{
  padding:12px 14px 16px;
  position:relative;
  z-index:3;
}

.name{
  font-family:'Cinzel', serif;
  font-size:16px;
  font-weight:800;
  text-align:center;
  margin:6px 0 8px;
  display:flex;
  justify-content:center;
  align-items:center;
  gap:8px;
  color:transparent;
  background-image:linear-gradient(180deg, var(--gold-1) 0%, var(--gold-3) 52%, var(--gold-2) 100%);
  -webkit-background-clip:text;
  background-clip:text;
  text-shadow:0 0 18px rgba(199,160,8,0.12);
}

.dot{
  width:9px; height:9px;
  border-radius:50%;
  background:#2ecc71;
  animation:blink 1s infinite;
  box-shadow:0 0 12px rgba(46,204,113,0.40);
}
@keyframes blink{ 50%{ opacity:0; } }
.dot.ocupado{ background:#e67e22; animation:none; box-shadow:none; }
.dot.indisp{ background:#e74c3c; animation:none; box-shadow:none; }

.stars{
  color:transparent;
  background-image:linear-gradient(180deg, var(--gold-2) 0%, var(--gold-3) 55%, var(--gold-4) 100%);
  -webkit-background-clip:text;
  background-clip:text;
  text-align:center;
  margin-bottom:8px;
  font-size:14px;
  text-shadow:0 0 18px rgba(199,160,8,0.12);
}

.price{
  text-align:center;
  font-size:13px;
  color:rgba(255,255,255,0.90);
  margin-bottom:12px;
}
.price b{
  color:transparent;
  background-image:linear-gradient(180deg, var(--gold-2) 0%, var(--gold-3) 45%, var(--gold-1) 80%);
  -webkit-background-clip:text;
  background-clip:text;
}

/* Botões */
.btn{
  width:100%;
  height:var(--btn-h);
  display:flex;
  align-items:center;
  justify-content:center;
  text-align:center;
  padding:0 var(--btn-px);
  border-radius:16px;
  text-decoration:none;
  font-weight:900;
  font-size:13px;
  letter-spacing:0.7px;
  line-height:1.15;
  white-space:normal;
  overflow:visible;
  box-sizing:border-box;
  box-shadow:
    0 16px 30px rgba(0,0,0,0.55),
    0 0 0 1px rgba(255,240,166,0.06) inset;
  border:1px solid rgba(255,255,255,0.10);
  transition:filter .18s ease;
}
@media (max-width:480px){
  .btn{ font-size:12px; }
}

.btn.disponivel{
  background:
    radial-gradient(220px 90px at 50% 0%, rgba(255,240,166,0.18), rgba(0,0,0,0) 65%),
    linear-gradient(180deg, rgba(199,160,8,0.95) 0%, rgba(184,134,11,0.95) 38%, rgba(246,226,122,0.95) 100%);
  color:#111;
  border-color:rgba(255,240,166,0.22);
  text-shadow:0 1px 0 rgba(255,255,255,0.15);
}
.btn:hover{ filter:brightness(1.06); }

.btn.ocupado{
  background:linear-gradient(180deg, #f39c12 0%, #d35400 100%);
  color:#111;
  pointer-events:none;
}
.btn.indisp{
  background:linear-gradient(180deg, #e74c3c 0%, #c0392b 100%);
  color:#fff;
  pointer-events:none;
}

.card.novo{
  border-color:rgba(246,226,122,0.95);
  box-shadow:
    0 20px 50px rgba(0,0,0,0.62),
    0 0 0 1px rgba(246,226,122,0.10) inset,
    0 0 22px rgba(199,160,8,0.10);
}

/* ==========================================================
   ✅ BLOQUEIO DE PROPAGANDAS INJETADAS (FabApp / similares)
========================================================== */
fabapp-banner-footer,
fabapp-banner-footer *{
  display:none !important;
  visibility:hidden !important;
  opacity:0 !important;
  height:0 !important;
  max-height:0 !important;
  min-height:0 !important;
  width:0 !important;
  max-width:0 !important;
  overflow:hidden !important;
  pointer-events:none !important;
}

#ads-container,
[id="ads-container"],
[id*="ads-container"],
[class*="ads-container"],
iframe[src*="fabapp-ads"],
video[src*="fabapp-ads"],
source[src*="fabapp-ads"]{
  display:none !important;
  visibility:hidden !important;
  opacity:0 !important;
  height:0 !important;
  max-height:0 !important;
  overflow:hidden !important;
  pointer-events:none !important;
}

/* ==========================================================
   ✅ POPUP DE INSTALAÇÃO DO APP (PWA) - SEMPRE APARECER
========================================================== */
.app-popup-overlay{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,0.72);
  backdrop-filter: blur(4px);
  z-index:99999;
  display:none;
  align-items:center;
  justify-content:center;
  padding:18px;
}
.app-popup{
  width:min(520px, 96vw);
  border-radius:18px;
  overflow:hidden;
  border:1px solid rgba(199,160,8,0.55);
  background:
    radial-gradient(560px 260px at 50% -10%, rgba(199,160,8,0.25), rgba(0,0,0,0) 60%),
    linear-gradient(180deg, rgba(18,18,18,0.96) 0%, rgba(5,5,5,0.99) 100%);
  box-shadow:0 30px 80px rgba(0,0,0,0.70);
  position:relative;
}
.app-popup .inner{
  padding:18px 16px 16px;
}
.app-popup .close{
  position:absolute;
  top:10px;
  right:10px;
  width:42px;
  height:42px;
  border-radius:12px;
  border:1px solid rgba(255,255,255,0.10);
  background:rgba(0,0,0,0.35);
  color:#fff;
  cursor:pointer;
  font-size:20px;
  line-height:1;
  display:flex;
  align-items:center;
  justify-content:center;
  box-shadow:0 14px 30px rgba(0,0,0,0.55);
}
.app-popup .head{
  display:flex;
  align-items:center;
  gap:12px;
  margin-bottom:10px;
}
.app-popup .logo{
  width:54px;
  height:54px;
  border-radius:14px;
  overflow:hidden;
  border:1px solid rgba(199,160,8,0.35);
  box-shadow:0 12px 26px rgba(0,0,0,0.55);
  background:#000;
  flex:0 0 auto;
}
.app-popup .logo img{
  width:100%;
  height:100%;
  object-fit:cover;
  display:block;
}
.app-popup h2{
  margin:0;
  font-family:'Cinzel', serif;
  font-size:18px;
  letter-spacing:0.2px;
  color:transparent;
  background-image:linear-gradient(180deg, var(--gold-1) 0%, var(--gold-3) 55%, var(--gold-2) 100%);
  -webkit-background-clip:text;
  background-clip:text;
}
.app-popup p{
  margin:8px 0 14px;
  color:rgba(255,255,255,0.88);
  font-size:14px;
  line-height:1.6;
}
.app-popup .actions{
  display:grid;
  grid-template-columns:1fr;
  gap:10px;
}
.app-btn{
  height:56px;
  border-radius:16px;
  border:1px solid rgba(255,255,255,0.10);
  display:flex;
  align-items:center;
  justify-content:center;
  font-weight:900;
  letter-spacing:0.7px;
  cursor:pointer;
  box-shadow: 0 16px 30px rgba(0,0,0,0.55);
}
.app-btn.primary{
  background:
    radial-gradient(220px 90px at 50% 0%, rgba(255,240,166,0.18), rgba(0,0,0,0) 65%),
    linear-gradient(180deg, rgba(199,160,8,0.95) 0%, rgba(184,134,11,0.95) 38%, rgba(246,226,122,0.95) 100%);
  color:#111;
}
.app-btn.secondary{
  background:rgba(255,255,255,0.08);
  color:#fff;
}
.app-popup .small{
  margin-top:10px;
  font-size:12px;
  color:rgba(255,255,255,0.70);
}
</style>
</head>

<body>

<!-- ✅ Carrossel (8s) -->
<div class="banner-carousel" id="bannerCarousel" aria-label="Carrossel de banners">
  <div class="spacer">
    <img src="https://i.ibb.co/ZRmkC0xL/Chat-GPT-Image-10-01-2026-20-47-55.png" alt="" />
  </div>

  <div class="slide active">
    <img src="https://i.ibb.co/ZRmkC0xL/Chat-GPT-Image-10-01-2026-20-47-55.png" alt="Cartomantes Online - Banner" />
  </div>

  <div class="slide">
    <img src="https://i.ibb.co/bMmJcykt/Chat-GPT-Image-10-01-2026-22-08-33.png" alt="Como se consultar" />
  </div>

  <div class="slide">
    <img src="https://i.ibb.co/rRvmn4Q7/56e5b5c7-3199-4b85-a6d8-22608f6c0402.png" alt="Banner adicional" />
  </div>
</div>

<div class="page">

  <section class="hero">
    <h1>Consulta de tarot online</h1>
    <p>
      Maior portal de Tarot Online por chat pré-pago. Profissionais selecionados em diversas áreas para ajudar e orientar
      com carinho, respeito, segurança e sigilo. Suporte humanizado, conte conosco.
    </p>
  </section>

  <div class="container" id="cards-container"></div>

</div>

<!-- ✅ POPUP INSTALAR APP -->
<div class="app-popup-overlay" id="appPopup" aria-hidden="true">
  <div class="app-popup" role="dialog" aria-modal="true" aria-label="Instalar aplicativo">
    <button class="close" id="appPopupClose" aria-label="Fechar">✕</button>
    <div class="inner">
      <div class="head">
        <div class="logo"><img src="logo.png" alt="Logo do aplicativo"></div>
        <div>
          <h2>Baixe o aplicativo do site</h2>
          <div class="small">Instale no celular e acesse mais rápido.</div>
        </div>
      </div>

      <p>Toque em <b>BAIXAR O APLICATIVO</b> para instalar o app na sua tela inicial.</p>

      <div class="actions">
        <button class="app-btn primary" id="installAppBtn">BAIXAR O APLICATIVO</button>
        <button class="app-btn secondary" id="laterAppBtn">AGORA NÃO</button>
      </div>

      <div class="small" id="iosHint" style="display:none;">
        No iPhone: toque em <b>Compartilhar</b> → <b>Adicionar à Tela de Início</b>.
      </div>
    </div>
  </div>
</div>

<script>
/* ✅ Registrar Service Worker (necessário para PWA) */
if ("serviceWorker" in navigator) {
  window.addEventListener("load", () => {
    navigator.serviceWorker.register("./service-worker.js").catch(()=>{});
  });
}

/* ==========================================================
   ✅ REMOÇÃO FORÇADA (se o host injetar de novo, apaga na hora)
========================================================== */
(function bloquearPropagandasInjetadas(){
  const SELECTORS = [
    'fabapp-banner-footer',
    'fabapp-banner-footer video',
    '#ads-container',
    '[id="ads-container"]',
    'iframe[src*="fabapp-ads"]',
    'video[src*="fabapp-ads"]',
    'source[src*="fabapp-ads"]',
    'script[src*="fabapp-ads"]'
  ];

  function remover() {
    for (const sel of SELECTORS) {
      document.querySelectorAll(sel).forEach(el => {
        try { el.remove(); } catch {}
      });
    }
  }

  remover();
  const obs = new MutationObserver(() => remover());
  obs.observe(document.documentElement, { childList:true, subtree:true });

  let tries = 0;
  const t = setInterval(() => {
    remover();
    tries++;
    if (tries >= 30) clearInterval(t);
  }, 500);
})();

/* ===========================
   ✅ CARROSSEL (8s)
=========================== */
(function initBannerCarousel(){
  const carousel = document.getElementById('bannerCarousel');
  if(!carousel) return;

  const slides = Array.from(carousel.querySelectorAll('.slide'));
  if(slides.length <= 1) return;

  let i = 0;

  function show(index){
    slides.forEach((s, k) => s.classList.toggle('active', k === index));
  }

  setInterval(() => {
    i = (i + 1) % slides.length;
    show(i);
  }, 8000);
})();

/* ===========================
   ✅ POPUP + INSTALAR APP (PWA) - SEMPRE APARECER
   - Android/Chrome: só dá pra "instalar" se tiver beforeinstallprompt
   - iPhone/Safari: não tem beforeinstallprompt, então mostra dica
=========================== */
(function initInstallPopup(){
  const popup = document.getElementById('appPopup');
  const btnInstall = document.getElementById('installAppBtn');
  const btnLater = document.getElementById('laterAppBtn');
  const btnClose = document.getElementById('appPopupClose');
  const iosHint = document.getElementById('iosHint');

  let deferredPrompt = null;

  const isStandalone = () =>
    (window.matchMedia && window.matchMedia('(display-mode: standalone)').matches) ||
    window.navigator.standalone === true;

  const isIOS = () => /iphone|ipad|ipod/i.test(navigator.userAgent);

  function openPopup(){
    popup.style.display = 'flex';
    popup.setAttribute('aria-hidden','false');
  }
  function closePopup(){
    popup.style.display = 'none';
    popup.setAttribute('aria-hidden','true');
  }

  // ✅ SEMPRE que abrir (desde que não esteja instalado)
  function alwaysShowIfNotInstalled(){
    if (isStandalone()) return;

    // iOS: mostra dica sempre
    if (isIOS()) {
      iosHint.style.display = 'block';
      setTimeout(openPopup, 800);
      return;
    }

    // Android/Chrome: abre popup sempre.
    // Se ainda não tiver beforeinstallprompt, o botão vai mostrar mensagem.
    setTimeout(openPopup, 800);
  }

  // Android/Chrome: captura o evento de instalação
  window.addEventListener('beforeinstallprompt', (e) => {
    e.preventDefault();
    deferredPrompt = e;
  });

  // Mostra popup sempre ao carregar
  window.addEventListener('load', alwaysShowIfNotInstalled);

  btnInstall.addEventListener('click', async () => {
    // iOS: só dica (não existe prompt nativo)
    if (isIOS()) {
      iosHint.style.display = 'block';
      return;
    }

    // Chrome/Android: se não tiver prompt disponível, avisa
    if (!deferredPrompt) {
      alert('Para instalar: use o Chrome no Android e abra o menu ⋮ > "Instalar app".');
      return;
    }

    closePopup();
    deferredPrompt.prompt();
    try { await deferredPrompt.userChoice; } catch {}
    deferredPrompt = null;
  });

  function dismiss(){
    closePopup();
  }

  btnLater.addEventListener('click', dismiss);
  btnClose.addEventListener('click', dismiss);
  popup.addEventListener('click', (e) => { if (e.target === popup) dismiss(); });
})();

/* ===========================
   LISTA DE CONSULTORES
=========================== */
const consultores = [
  { nome: "P.Márcio", valor: 3, imagem: "https://i.ibb.co/B5wwzSHD/Imagem-do-Whats-App-de-2025-10-31-s-12-44-22-8316baa5.jpg", estrelas: 5 },
  { nome: "Flora", valor: 1, imagem: "https://www.mestresmisticos.com.br/Assets/Imagens/2025/11/06//5dfb048cce-1-_3.webp", estrelas: 5, novo: true },

  { nome: "Carina", valor: 1, imagem: "https://www.mestresmisticos.com.br/Assets/Imagens/2025/12/04//5aea31bd77-1-_3.webp", estrelas: 5, novo: true },
  { nome: "Dalila", valor: 1, imagem: "https://www.mestresmisticos.com.br/Assets/Imagens/2025/10/11//0b284c7b42-1-_3.webp", estrelas: 5, novo: true },
  { nome: "Adria", valor: 1, imagem: "https://www.mestresmisticos.com.br/Assets/Imagens/2025/07/25//d6152621b2-1-_3.webp", estrelas: 5, novo: true },
  { nome: "Thabata", valor: 1, imagem: "https://www.mestresmisticos.com.br/Assets/Imagens/2025/06/28//d5969655ef-1-_3.webp", estrelas: 5, novo: true },
  { nome: "Analu", valor: 1, imagem: "https://www.mestresmisticos.com.br/Assets/Imagens/2025/12/19//fe3f4b6a8a-1-_3.webp", estrelas: 5, novo: true },
  { nome: "Benedita", valor: 1, imagem: "https://www.mestresmisticos.com.br/Assets/Imagens/2025/10/23//9f9ffa4ba9-1-_3.webp", estrelas: 5, novo: true },
  { nome: "Estrela", valor: 1, imagem: "https://www.mestresmisticos.com.br/Assets/Imagens/2026/01/01//b2a24fc4f7-1-_3.webp", estrelas: 5, novo: true },

  { nome: "Sulamita", valor: 1, imagem: "https://www.rainhasdotarot.com.br/Assets/Imagens/2024/05/27//47a447851c-1-.jpg", estrelas: 5 },
  { nome: "Esmeralda", valor: 1, imagem: "https://www.rainhasdotarot.com.br/Assets/Imagens/2020/05/18//41c4696d05-1-.jpg", estrelas: 5 },
  { nome: "M.Padilha", valor: 1, imagem: "https://www.rainhasdotarot.com.br/Assets/Imagens/2025/01/27//699974ac8a-1-.jpg", estrelas: 4 },
  { nome: "Sara", valor: 1, imagem: "https://www.rainhasdotarot.com.br/Assets/Imagens/2024/09/04//9a6f4cec30-1-.jpg", estrelas: 5 },
  { nome: "7 Saias", valor: 1, imagem: "https://www.rainhasdotarot.com.br/Assets/Imagens/2024/02/29//e43513a707-1-.jpg", estrelas: 5 },
  { nome: "Odara", valor: 1, imagem: "https://www.rainhasdotarot.com.br/Assets/Imagens/2024/01/15//91bb2a4455-1-.jpg", estrelas: 5 },
  { nome: "Luara", valor: 1, imagem: "https://www.rainhasdotarot.com.br/Assets/Imagens/2024/08/24//dc4e2cb494-1-.jpg", estrelas: 5 }
];

const container = document.getElementById('cards-container');

/* ===========================
   RENDER DOS CARDS
=========================== */
consultores.forEach((c, idx) => {
  const card = document.createElement('div');
  card.className = 'card' + (c.novo ? ' novo' : '');
  card.dataset.idx = String(idx);

  card.innerHTML = `
    <div class="img-wrap">
      <img src="${c.imagem}" alt="${c.nome}">
    </div>
    <span class="badge">Online</span>
    <div class="content">
      <div class="name">${c.nome} <span class="dot"></span></div>
      <div class="stars">${'★'.repeat(c.estrelas)}${'☆'.repeat(5 - c.estrelas)}</div>
      <div class="price"><b>R$ ${Number(c.valor).toFixed(2)} por minuto</b></div>
      <a href="#" class="btn disponivel">INICIAR CONSULTA</a>
    </div>
  `;

  card.querySelector('.btn').addEventListener('click', (e) => {
    e.preventDefault();
    if (card.dataset.status !== "online") return;

    localStorage.clear();
    localStorage.setItem('consultorNome', c.nome);
    localStorage.setItem('consultorValor', c.valor);
    localStorage.setItem('consultorImagem', c.imagem);

    window.location.href = 'https://marcio2307.github.io/cartomantesonline.site/pix.html';
  });

  container.appendChild(card);
});

/* ===========================
   ✅ COMPORTAMENTO REALISTA
=========================== */
function horarioIndisponivelGlobal() {
  const h = new Date().getHours();
  return h >= 2 && h < 10;
}

const clamp = (n, a, b) => Math.max(a, Math.min(b, n));
const randInt = (a, b) => Math.floor(a + Math.random() * (b - a + 1));
const chance = (p) => Math.random() < p;

function gerarEscalaDescanso() {
  const janelas = [];
  const qtd = chance(0.45) ? 2 : 1;

  for (let i = 0; i < qtd; i++) {
    let inicio = randInt(10, 21);
    let dur = chance(0.20) ? 3 : (chance(0.55) ? 2 : 1);
    let fim = clamp(inicio + dur, 10, 23);

    if (janelas.some(j => Math.abs(j.inicio - inicio) < 2)) {
      inicio = clamp(inicio + 2, 10, 22);
      fim = clamp(inicio + dur, 10, 23);
    }

    janelas.push({ inicio, fim });
  }

  if (chance(0.12)) {
    const start = randInt(12, 18);
    janelas.push({ inicio:start, fim: clamp(start + 1, 10, 23) });
  }

  return janelas;
}

const STORAGE_KEY = "status_realista_v1";
let estado = null;

function carregarEstado() {
  try {
    const raw = sessionStorage.getItem(STORAGE_KEY);
    if (!raw) return null;
    const parsed = JSON.parse(raw);
    if (!parsed || !Array.isArray(parsed.consultores)) return null;
    return parsed;
  } catch { return null; }
}

function salvarEstado() {
  try { sessionStorage.setItem(STORAGE_KEY, JSON.stringify(estado)); } catch {}
}

function initEstado() {
  const dia = new Date().toDateString();
  const anterior = carregarEstado();

  if (anterior && anterior.dia === dia && anterior.consultores?.length === consultores.length) {
    estado = anterior;
    return;
  }

  estado = {
    dia,
    consultores: consultores.map(() => ({
      descanso: gerarEscalaDescanso(),
      status: "online",
      holdUntil: 0
    }))
  };

  aplicarStatusRealista(true);
  salvarEstado();
}

function emDescansoPorEscala(idx, hora) {
  return estado.consultores[idx].descanso.some(w => hora >= w.inicio && hora < w.fim);
}

function setStatusDOM(card, status) {
  const badge = card.querySelector('.badge');
  const dot = card.querySelector('.dot');
  const btn = card.querySelector('.btn');

  card.dataset.status = status;

  badge.classList.remove('ocupado','indisp');
  dot.classList.remove('ocupado','indisp');
  btn.classList.remove('ocupado','indisp','disponivel');

  dot.style.animation = '';

  if (status === "online") {
    badge.textContent = 'Online';
    dot.style.animation = 'blink 1s infinite';
    btn.textContent = 'INICIAR CONSULTA';
    btn.classList.add('disponivel');
    btn.style.pointerEvents = '';
  } else if (status === "ocupado") {
    badge.textContent = 'Ocupado';
    badge.classList.add('ocupado');
    dot.classList.add('ocupado');
    dot.style.animation = 'none';
    btn.textContent = 'OCUPADO';
    btn.classList.add('ocupado');
    btn.style.pointerEvents = 'none';
  } else {
    badge.textContent = 'Indisponível';
    badge.classList.add('indisp');
    dot.classList.add('indisp');
    dot.style.animation = 'none';
    btn.textContent = 'INDISPONÍVEL';
    btn.classList.add('indisp');
    btn.style.pointerEvents = 'none';
  }
}

function aplicarStatusRealista(forceAll = false) {
  const now = Date.now();
  const hora = new Date().getHours();
  const cards = Array.from(document.querySelectorAll('.card'));

  if (horarioIndisponivelGlobal()) {
    cards.forEach((card, i) => {
      estado.consultores[i].status = "indisp";
      estado.consultores[i].holdUntil = now + 10 * 60 * 1000;
      setStatusDOM(card, "indisp");
    });
    salvarEstado();
    return;
  }

  const indisponiveisFixos = [];
  cards.forEach((_, i) => {
    if (emDescansoPorEscala(i, hora)) indisponiveisFixos.push(i);
  });

  const alvoIndisp = chance(0.55) ? 1 : 2;
  const indispSet = new Set(indisponiveisFixos);

  if (indispSet.size < alvoIndisp) {
    const candidatos = cards.map((_, i) => i).filter(i => !indispSet.has(i));
    while (indispSet.size < alvoIndisp && candidatos.length) {
      const pick = candidatos.splice(randInt(0, candidatos.length - 1), 1)[0];
      indispSet.add(pick);
      estado.consultores[pick].holdUntil = now + randInt(25, 60) * 60 * 1000;
    }
  }

  let ocupProb = 0.40;
  if (hora >= 10 && hora < 13) ocupProb = 0.35;
  if (hora >= 13 && hora < 18) ocupProb = 0.42;
  if (hora >= 18 && hora < 23) ocupProb = 0.52;
  if (hora >= 23 || hora < 2) ocupProb = 0.33;

  cards.forEach((card, i) => {
    const st = estado.consultores[i];
    const bloqueado = indispSet.has(i);
    const emHold = !forceAll && st.holdUntil && now < st.holdUntil;

    if (bloqueado) {
      st.status = "indisp";
      if (!st.holdUntil || st.holdUntil < now) {
        st.holdUntil = now + randInt(20, 55) * 60 * 1000;
      }
      setStatusDOM(card, "indisp");
      return;
    }

    if (emHold) {
      setStatusDOM(card, st.status);
      return;
    }

    const podeMudar = chance(0.55);
    if (!podeMudar) {
      st.holdUntil = now + randInt(6, 14) * 60 * 1000;
      setStatusDOM(card, st.status);
      return;
    }

    const novoStatus = chance(ocupProb) ? "ocupado" : "online";
    st.status = novoStatus;

    st.holdUntil = (novoStatus === "ocupado")
      ? now + randInt(8, 22) * 60 * 1000
      : now + randInt(5, 16) * 60 * 1000;

    setStatusDOM(card, novoStatus);
  });

  salvarEstado();
}

/* START */
initEstado();
aplicarStatusRealista(false);
setInterval(() => aplicarStatusRealista(false), 45000);
document.addEventListener('visibilitychange', () => {
  if (!document.hidden) aplicarStatusRealista(false);
});
</script>

</body>
</html>
